/*! Garm Form Validator v1.0.3 | (c) 2014 FAKTOR VIER GmbH | http://faktorvier.ch */
(function(d){d.garm={debugMode:!1,setValidator:function(a,b){d.garm.validators[a]=b},setConfig:function(a,b){d.garm.config[a]=b},info:function(a){d.garm.debugMode&&console.info("GARM: "+a)},warn:function(a){d.garm.debugMode&&console.warn("GARM: "+a)}};d.garm.validators={email:/^((([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-\u00c4\u00e4\u00d6\u00f6\u00dc\u00fc\u00df\-0-9]+\.)+[a-zA-Z]{2,}))|\s*)$/,url:/^((https?:\/\/(www\.)?[-a-zA-Z0-9@:%._\+~#=\u00c4\u00e4\u00d6\u00f6\u00dc\u00fc\u00df]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))|\s*)$/,
integer:/^((\-?[0-9]+)|\s*)$/,decimal:/^((\-?\d+\.\d{1,})|\s*)$/,alpha:/^(([a-z]+)|\s*)$/i,alphanumeric:/^(([a-z0-9]+)|\s*)$/i,password:/^(((?=.{8,})(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[!@#$&\*]).*)|\s*)$/,required:function(a,b,c){var d=!0;a[0]=a[0]||1;a[1]=a[1]||-1;"select"==c[0].tagName.toLowerCase()&&c.prop("multiple")?(b=c.find("option:selected").length,d&&0!==a[0]&&(d=b>=+a[0]),d&&-1!==a[1]&&(d=b<=+a[1])):d="checkbox"==c.attr("type")?c.is(":checked"):/^\s*\S.*$/m.test(b);return d},creditcard:function(a,
b){b="undefined"!=typeof a[0]&&"strict"==a[0]?b:b.replace(/[\s\-]*/g,"");return/^(((?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|3(?:0[0-5]|[68][0-9])[0-9]{11}|6(?:011|5[0-9]{2})[0-9]{12}|(?:2131|1800|35\d{3})\d{11})[\s]{0,4})|\s*)$/.test(b)},number:function(a,b){b=d.trim(b);var c=!isNaN(b)||""==b;a[0]=a[0]||"n";a[1]=a[1]||"n";c&&""!=b&&!isNaN(a[0])&&(c=+b>=+a[0]);c&&""!=b&&!isNaN(a[1])&&(c=+b<=+a[1]);return c},length:function(a,b){b=d.trim(b);var c=!0;a[0]=a[0]||0;a[1]=a[1]||-1;c&&""!=
b&&0!==a[0]&&(c=b.length>=+a[0]);c&&""!=b&&-1!==a[1]&&(c=b.length<=+a[1]);return c},match:function(a,b){return-1!=d.map(a,function(a){return a.toLowerCase()}).indexOf(b.toLowerCase())||""==b},"match-case":function(a,b){return-1!=a.indexOf(b)||""==b},"match-field":function(a,b){var c=!0;d(a.join(",")).each(function(){if(d(this).val()!=b)return c=!1});return c},date:function(a,b){a[0]=a[0]||"d.m.y";var c=a[0].substr(1,1),f=a[0].split(c),c=b.split(c);return""==d.trim(b)||f.length==c.length&&!isNaN(Date.parse(c[f.indexOf("m")]+
"."+c[f.indexOf("d")]+"."+c[f.indexOf("y")]))},checkboxgroup:function(a,b,c){a[0]=a[0]||0;a[1]=a[1]||-1;b=c.find('input[type="checkbox"]:checked').length;(c=b>=+a[0])&&-1!==a[1]&&(c=b<=+a[1]);return c}};d.garm.config={classFormBusy:"busy",classFieldError:"error",classFieldLoading:"loading",classLabelError:"",attr:"data-garm",attrIgnore:"data-garm-ignore",onlyValidate:!1,beforeSubmit:function(){},onSubmit:function(a){},onSuccess:function(a){},onFail:function(a,b){}};d.garm.validate=function(a,b,c){a.beforeSubmit();
if(c.hasClass(a.classFormBusy))return d.garm.info("VALIDATION ALREADY BUSY"),!1;d.garm.info("VALIDATION STARTED");var f=c.find("["+a.attr+"]").not("["+a.attr+'=""]'),k=c.find("label"),n=0,m={},r=[];f.removeClass(a.classFieldError);k.removeClass(a.classLabelError);c.addClass(a.classFormBusy);f.each(function(){var e=d(this),f=e.val(),h=e.attr("name"),k=e.attr(a.attr).split(" "),t;for(t in k){var g=k[t],u=[];-1!==g.indexOf("[")&&(u=g.substring(g.indexOf("[")+1,g.length-1).split(","),g=g.substring(0,
g.indexOf("[")));var p=e.is("["+a.attrIgnore+'~="'+g+'"]')||e.is("["+a.attrIgnore+'="all"]'),q=e.parents("["+a.attrIgnore+"]");q.length&&(p=q.is("["+a.attrIgnore+'~="'+g+'"]')||q.is("["+a.attrIgnore+'="all"]'));p&&d.garm.info("validation ignored (field: "+h+", validator: "+g+")");if(g in b&&!e.hasClass(a.classFieldError)&&!p){var l=b[g];r.push(function(){var b=d.Deferred();if("function"==typeof l){var k=l(u,f,e,c,b);"undefined"==typeof k||"undefined"==typeof k.promise?b.resolve(1==k):(b=k,e.addClass(a.classFieldLoading))}else"string"==
typeof l&&0===l.indexOf("http")?(e.addClass(a.classFieldLoading),d.get(l,{value:f}).always(function(a){b.resolve(1==d.trim(a))})):l instanceof RegExp&&b.resolve(l.test(f));b.always(function(b){e.removeClass(a.classFieldLoading);0==b&&(n++,"undefined"!=typeof h&&("undefined"==typeof m[h]&&(m[h]=[]),m[h].push(g)),e.addClass(a.classFieldError),c.find('label[for="'+e.attr("id")+'"]').addClass(a.classLabelError),d.garm.debugMode&&("undefined"==typeof h&&(h=e[0].tagName.toLowerCase(),h+=e.is("[id]")?"#"+
e.attr("id"):""),d.garm.warn("validation failed (field: "+h+", validator: "+g+")")))});return b.promise()}())}}});d.when.apply(d,r).done(function(){a.onSubmit(c);if(0===n){d.garm.info("VALIDATION ENDED: SUCCESS");if("undefined"!=typeof a.onSuccess(c))return!0;a.onlyValidate?c.removeClass(a.classFormBusy):c.off("submit.garm").submit()}else if(c.removeClass(a.classFormBusy),d.garm.warn("VALIDATION ENDED: "+n+" FIELDS FAILED"),"undefined"!=typeof a.onFail(c,m))return!0});return!0};d.fn.garm=function(a,
b){var c=d.extend(d.extend({},d.garm.config),a),f=d.extend(d.extend({},d.garm.validators),b);return this.each(function(){if(c.onlyValidate)d(this).each(function(){d.garm.validate(c,f,d(this))});else d(this).on("submit.garm",function(a){a.preventDefault();d.garm.validate(c,f,d(this))})})}})(jQuery);